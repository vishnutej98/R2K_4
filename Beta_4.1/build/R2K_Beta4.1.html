<html>
<head>
<title>R2K_Beta4.1.py</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #0033b3;}
.s1 { color: #080808;}
.s2 { color: #008080; font-weight: bold;}
.s3 { color: #1750eb;}
.s4 { color: #0037a6;}
.s5 { color: #8c8c8c; font-style: italic;}
</style>
</head>
<body bgcolor="#ffffff">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#c0c0c0" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
R2K_Beta4.1.py</font>
</center></td></tr></table>
<pre><span class="s0">from </span><span class="s1">math </span><span class="s0">import </span><span class="s1">pi</span>

<span class="s1">print(</span><span class="s2">''' 
Data Sheet of the Vehicle 
please enter the required specification for the vehicle 
'''</span><span class="s1">)</span>

<span class="s2">&quot;&quot;&quot; 
The following line from ln 6 to ln 15, we are getting user input for the particular variables. 
The values are stored based on the variable units. 
&quot;&quot;&quot;</span>
<span class="s1">Vehicle_name = str(input(</span><span class="s2">&quot;Enter the Vehicle Name: &quot;</span><span class="s1">)).title()</span>
<span class="s1">Gear = int(input(</span><span class="s2">&quot;No. of Gears: &quot;</span><span class="s1">))</span>
<span class="s0">if </span><span class="s1">Gear &gt;= </span><span class="s3">6</span><span class="s1">:</span>
    <span class="s1">print(</span><span class="s2">&quot;Sorry! this file will calculate only for 4 or 5 speed gear box.&quot;</span><span class="s1">)</span>
    <span class="s0">pass</span>
<span class="s0">else</span><span class="s1">:</span>
    <span class="s1">Primary = float(input(</span><span class="s2">&quot;Primary transmission ratio: &quot;</span><span class="s1">))</span>
    <span class="s1">Secondary = float(input(</span><span class="s2">&quot;Secondary transmission ratio: &quot;</span><span class="s1">))</span>
    <span class="s1">Rolling_Radius = float(input(</span><span class="s2">&quot;Rolling radius: &quot;</span><span class="s1">))</span>
    <span class="s1">peak_power_rpm = float(input(</span><span class="s2">&quot;Peak Power RPM: &quot;</span><span class="s1">))</span>
    <span class="s1">Gear_2 = float(input(</span><span class="s2">&quot;2nd Gear ratio: &quot;</span><span class="s1">))</span>
    <span class="s1">Gear_3 = float(input(</span><span class="s2">&quot;3rd Gear ratio: &quot;</span><span class="s1">))</span>
    <span class="s1">total_2nd_gear_ratio = round(Primary * Secondary * Gear_2, </span><span class="s3">3</span><span class="s1">)</span>
    <span class="s1">total_3rd_gear_ratio = round(Primary * Secondary * Gear_3, </span><span class="s3">3</span><span class="s1">)</span>


    <span class="s0">def </span><span class="s1">fact(pi, rolling_radius):</span>
        <span class="s1">factor = round(</span><span class="s3">2 </span><span class="s1">* pi * rolling_radius * </span><span class="s3">0.06</span><span class="s1">, </span><span class="s3">3</span><span class="s1">)</span>
        <span class="s0">return </span><span class="s1">factor</span>


    <span class="s1">fact = fact(pi, Rolling_Radius)</span>


    <span class="s0">class </span><span class="s1">calculation():</span>
        <span class="s1">@staticmethod</span>
        <span class="s0">def </span><span class="s1">RPM_to_KPH_ratio_2nd_Gear(total_2nd_gear_ratio, fact):</span>
            <span class="s1">RPM_to_KPH_ratio_2nd_Gear = round(total_2nd_gear_ratio / fact, </span><span class="s3">3</span><span class="s1">)</span>
            <span class="s0">return </span><span class="s1">RPM_to_KPH_ratio_2nd_Gear</span>

        <span class="s1">@staticmethod</span>
        <span class="s0">def </span><span class="s1">RPM_to_KPH_ratio_3rd_Gear(total_3rd_gear_ratio, fact):</span>
            <span class="s1">RPM_to_KPH_ratio_3rd_Gear = round(total_3rd_gear_ratio / fact, </span><span class="s3">3</span><span class="s1">)</span>
            <span class="s0">return </span><span class="s1">RPM_to_KPH_ratio_3rd_Gear</span>

        <span class="s1">@staticmethod</span>
        <span class="s0">def </span><span class="s1">Entry_Speed_2nd_Gear(peak_power_rpm, total_2nd_gear_ratio, fact):</span>
            <span class="s1">Entry_Speed_2nd_Gear = round(float(((</span><span class="s3">0.75 </span><span class="s1">* peak_power_rpm) / total_2nd_gear_ratio) * fact), </span><span class="s3">2</span><span class="s1">)</span>
            <span class="s0">return </span><span class="s1">Entry_Speed_2nd_Gear</span>

        <span class="s1">@staticmethod</span>
        <span class="s0">def </span><span class="s1">Entry_Speed_3rd_Gear(peak_power_rpm, Total_3rd_Gear_ratio, fact):</span>
            <span class="s1">Entry_Speed_3rd_Gear = round(float(((</span><span class="s3">0.75 </span><span class="s1">* peak_power_rpm) / Total_3rd_Gear_ratio) * fact), </span><span class="s3">2</span><span class="s1">)</span>
            <span class="s0">return </span><span class="s1">Entry_Speed_3rd_Gear</span>

        <span class="s1">@staticmethod</span>
        <span class="s0">def </span><span class="s1">Exit_Speed_2nd_Gear(peak_power_rpm, Total_2nd_Gear_ratio, fact):</span>
            <span class="s1">Exit_Speed_2nd_Gear = round(float((peak_power_rpm / Total_2nd_Gear_ratio) * fact), </span><span class="s3">2</span><span class="s1">)</span>
            <span class="s0">return </span><span class="s1">Exit_Speed_2nd_Gear</span>

        <span class="s1">@staticmethod</span>
        <span class="s0">def </span><span class="s1">Exit_Speed_3rd_Gear(peak_power_rpm, Total_3rd_Gear_ratio, fact):</span>
            <span class="s1">Exit_Speed_3rd_Gear = round(float((peak_power_rpm / Total_3rd_Gear_ratio) * fact), </span><span class="s3">2</span><span class="s1">)</span>
            <span class="s0">return </span><span class="s1">Exit_Speed_3rd_Gear</span>


    <span class="s1">spec_name = [</span>
            <span class="s2">&quot;Vehicle name&quot;</span><span class="s1">, </span><span class="s2">&quot;Gear Box&quot;</span><span class="s1">, </span><span class="s2">&quot;Factor = (2 * PI * R * 0.06)&quot;</span><span class="s1">, </span><span class="s2">&quot;Primary Gear Ratio&quot;</span><span class="s1">,</span>
            <span class="s2">&quot;Secondary Gear Ratio&quot;</span><span class="s1">, </span><span class="s2">&quot;Dynamic Rolling Radius in meters&quot;</span><span class="s1">, </span><span class="s2">&quot;Max Peak Power RPM&quot;</span><span class="s1">, </span><span class="s2">&quot;Total 2ndGear ratio&quot;</span><span class="s1">,</span>
            <span class="s2">&quot;Total 3rdGear ratio&quot;</span><span class="s1">, </span><span class="s2">&quot;2ndGear RPMtoKPH ratio&quot;</span><span class="s1">, </span><span class="s2">&quot;3rdGear RPMtoKPH ratio&quot;</span><span class="s1">, </span><span class="s2">&quot;Entry Speed at 2nd Gear in KPH&quot;</span><span class="s1">,</span>
            <span class="s2">&quot;Exit Speed at 2nd Gear in KPH&quot;</span><span class="s1">, </span><span class="s2">&quot;Entry Speed at 3rd Gear in KPH&quot;</span><span class="s1">, </span><span class="s2">&quot;Exit Speed at 3rd Gear in KPH&quot;</span>
    <span class="s1">]</span>
    <span class="s1">spec_list = [</span>
        <span class="s1">Vehicle_name, Gear, fact, Primary, Secondary, Rolling_Radius, peak_power_rpm, total_2nd_gear_ratio,</span>
        <span class="s1">total_3rd_gear_ratio,</span>
        <span class="s1">calculation.RPM_to_KPH_ratio_2nd_Gear(total_2nd_gear_ratio, fact),</span>
        <span class="s1">calculation.RPM_to_KPH_ratio_3rd_Gear(total_3rd_gear_ratio, fact),</span>
        <span class="s1">calculation.Entry_Speed_2nd_Gear(peak_power_rpm, total_2nd_gear_ratio, fact),</span>
        <span class="s1">calculation.Exit_Speed_2nd_Gear(peak_power_rpm, total_2nd_gear_ratio, fact),</span>
        <span class="s1">calculation.Entry_Speed_3rd_Gear(peak_power_rpm, total_3rd_gear_ratio, fact),</span>
        <span class="s1">calculation.Exit_Speed_3rd_Gear(peak_power_rpm, total_3rd_gear_ratio, fact)</span>

    <span class="s1">]</span>
    <span class="s1">print(</span><span class="s2">f&quot;The data will be calculated for </span><span class="s4">{</span><span class="s1">Vehicle_name</span><span class="s4">}</span><span class="s2">.&quot;</span><span class="s1">)</span>
    <span class="s1">print(</span><span class="s2">&quot;&quot;&quot; 
    Please select the option below to save the data in a file: 
     
        1. PDF(.pdf) 
        2. Excel(.xlsx) 
        3. Text(.txt) 
    &quot;&quot;&quot;</span><span class="s1">)</span>


    <span class="s1">user_input = int(input(</span><span class="s2">&quot;Enter numerical value only: &quot;</span><span class="s1">))</span>

    <span class="s0">if </span><span class="s1">user_input == </span><span class="s3">1</span><span class="s1">:</span>
        <span class="s1">file = open(</span><span class="s2">&quot;data.txt&quot;</span><span class="s1">, </span><span class="s2">&quot;w&quot;</span><span class="s1">)</span>
        <span class="s0">for </span><span class="s1">i </span><span class="s0">in </span><span class="s1">range(</span><span class="s3">0</span><span class="s1">, </span><span class="s3">7</span><span class="s1">):</span>
            <span class="s1">file.write(</span><span class="s2">f&quot;</span><span class="s4">{</span><span class="s1">spec_name[i]</span><span class="s4">} </span><span class="s2">: </span><span class="s4">{</span><span class="s1">spec_list[i]</span><span class="s4">}\n</span><span class="s2">&quot;</span><span class="s1">)</span>

        <span class="s1">file.write(</span><span class="s2">&quot;</span><span class="s4">\n</span><span class="s2">&quot;</span><span class="s1">)</span>
        <span class="s1">file.write(</span><span class="s2">&quot;</span><span class="s4">\n</span><span class="s2">&quot;</span><span class="s1">)</span>

        <span class="s0">for </span><span class="s1">j </span><span class="s0">in </span><span class="s1">range(</span><span class="s3">7</span><span class="s1">, </span><span class="s3">11</span><span class="s1">):</span>
            <span class="s1">file.write(</span><span class="s2">f&quot;</span><span class="s4">{</span><span class="s1">spec_name[j]</span><span class="s4">} </span><span class="s2">: </span><span class="s4">{</span><span class="s1">spec_list[j]</span><span class="s4">}\n</span><span class="s2">&quot;</span><span class="s1">)</span>

        <span class="s1">file.write(</span><span class="s2">&quot;</span><span class="s4">\n</span><span class="s2">&quot;</span><span class="s1">)</span>
        <span class="s1">file.write(</span><span class="s2">&quot;</span><span class="s4">\n</span><span class="s2">&quot;</span><span class="s1">)</span>

        <span class="s0">for </span><span class="s1">k </span><span class="s0">in </span><span class="s1">range(</span><span class="s3">11</span><span class="s1">, </span><span class="s3">15</span><span class="s1">):</span>
            <span class="s1">file.write(</span><span class="s2">f&quot;</span><span class="s4">{</span><span class="s1">spec_name[k]</span><span class="s4">} </span><span class="s2">: </span><span class="s4">{</span><span class="s1">spec_list[k]</span><span class="s4">}\n</span><span class="s2">&quot;</span><span class="s1">)</span>
        <span class="s1">file.close()</span>

        <span class="s0">from </span><span class="s1">fpdf </span><span class="s0">import </span><span class="s1">FPDF</span>
        <span class="s1">pdf = FPDF()</span>
        <span class="s1">pdf.add_page()</span>
        <span class="s1">pdf.set_font(</span><span class="s2">&quot;Times&quot;</span><span class="s1">, size=</span><span class="s3">14</span><span class="s1">)</span>
        <span class="s1">read_file = open(</span><span class="s2">&quot;data.txt&quot;</span><span class="s1">, </span><span class="s2">&quot;r&quot;</span><span class="s1">)</span>
        <span class="s0">for </span><span class="s1">x </span><span class="s0">in </span><span class="s1">read_file:</span>
            <span class="s1">pdf.cell(</span><span class="s3">200</span><span class="s1">, </span><span class="s3">10</span><span class="s1">, txt=x, ln=</span><span class="s3">1</span><span class="s1">, align=</span><span class="s2">'L'</span><span class="s1">)</span>
        <span class="s1">pdf.output(</span><span class="s2">f&quot;</span><span class="s4">{</span><span class="s1">Vehicle_name</span><span class="s4">}</span><span class="s2">.pdf&quot;</span><span class="s1">)</span>
        <span class="s1">print(</span><span class="s2">f&quot;Data is saved in PDF file named as </span><span class="s4">{</span><span class="s1">Vehicle_name</span><span class="s4">}</span><span class="s2">.&quot;</span><span class="s1">)</span>

    <span class="s0">elif </span><span class="s1">user_input == </span><span class="s3">2</span><span class="s1">:</span>
        <span class="s0">from </span><span class="s1">openpyxl </span><span class="s0">import </span><span class="s1">Workbook</span>
        <span class="s0">from </span><span class="s1">openpyxl.styles </span><span class="s0">import </span><span class="s1">Font</span>

        <span class="s1">book = Workbook()</span>
        <span class="s1">Sheet = book.active</span>
        <span class="s1">n = </span><span class="s3">0</span>
        <span class="s1">m = </span><span class="s3">0</span>
        <span class="s0">for </span><span class="s1">g </span><span class="s0">in </span><span class="s1">range(</span><span class="s3">5</span><span class="s1">, </span><span class="s3">20</span><span class="s1">):  </span><span class="s5"># Excel Result loop.</span>
            <span class="s1">Sheet[</span><span class="s2">f'C</span><span class="s4">{</span><span class="s1">g</span><span class="s4">}</span><span class="s2">'</span><span class="s1">] = </span><span class="s2">f'</span><span class="s4">{</span><span class="s1">spec_name[n]</span><span class="s4">}</span><span class="s2">'</span>
            <span class="s1">Sheet[</span><span class="s2">f'D</span><span class="s4">{</span><span class="s1">g</span><span class="s4">}</span><span class="s2">'</span><span class="s1">] = </span><span class="s2">f'</span><span class="s4">{</span><span class="s1">spec_list[m]</span><span class="s4">}</span><span class="s2">'</span>
            <span class="s1">n += </span><span class="s3">1</span>
            <span class="s1">m += </span><span class="s3">1</span>

        <span class="s5">#  Making Rows(Top two and bottom four rows) Bold.</span>
        <span class="s0">for </span><span class="s1">b </span><span class="s0">in </span><span class="s1">list(range(</span><span class="s3">4</span><span class="s1">, </span><span class="s3">6</span><span class="s1">)) + list(range(</span><span class="s3">16</span><span class="s1">, </span><span class="s3">21</span><span class="s1">)):</span>
            <span class="s1">Sheet[</span><span class="s2">f'C</span><span class="s4">{</span><span class="s1">b</span><span class="s4">}</span><span class="s2">'</span><span class="s1">].font = Font(bold=</span><span class="s0">True</span><span class="s1">)</span>
            <span class="s1">Sheet[</span><span class="s2">f'D</span><span class="s4">{</span><span class="s1">b</span><span class="s4">}</span><span class="s2">'</span><span class="s1">].font = Font(bold=</span><span class="s0">True</span><span class="s1">)</span>
            <span class="s1">Sheet.column_dimensions[</span><span class="s2">'C'</span><span class="s1">].width = </span><span class="s3">27.33</span>
        <span class="s1">book.save(str(Vehicle_name) + </span><span class="s2">&quot;.xlsx&quot;</span><span class="s1">)</span>
        <span class="s1">print(</span><span class="s2">f&quot;Data is saved in Excel file named as </span><span class="s4">{</span><span class="s1">Vehicle_name</span><span class="s4">}</span><span class="s2">.&quot;</span><span class="s1">)</span>

    <span class="s0">elif </span><span class="s1">user_input == </span><span class="s3">3</span><span class="s1">:</span>
        <span class="s1">file = open(</span><span class="s2">f&quot;</span><span class="s4">{</span><span class="s1">Vehicle_name</span><span class="s4">}</span><span class="s2">.txt&quot;</span><span class="s1">, </span><span class="s2">&quot;w&quot;</span><span class="s1">)</span>
        <span class="s0">for </span><span class="s1">i </span><span class="s0">in </span><span class="s1">range(</span><span class="s3">0</span><span class="s1">, </span><span class="s3">7</span><span class="s1">):</span>
            <span class="s1">file.write(</span><span class="s2">f&quot;</span><span class="s4">{</span><span class="s1">spec_name[i]</span><span class="s4">}</span><span class="s2">: </span><span class="s4">{</span><span class="s1">spec_list[i]</span><span class="s4">}\n</span><span class="s2">&quot;</span><span class="s1">)</span>

        <span class="s1">file.write(</span><span class="s2">&quot;</span><span class="s4">\n</span><span class="s2">&quot;</span><span class="s1">)</span>
        <span class="s1">file.write(</span><span class="s2">&quot;</span><span class="s4">\n</span><span class="s2">&quot;</span><span class="s1">)</span>

        <span class="s0">for </span><span class="s1">j </span><span class="s0">in </span><span class="s1">range(</span><span class="s3">7</span><span class="s1">, </span><span class="s3">11</span><span class="s1">):</span>
            <span class="s1">file.write(</span><span class="s2">f&quot;</span><span class="s4">{</span><span class="s1">spec_name[j]</span><span class="s4">}</span><span class="s2">: </span><span class="s4">{</span><span class="s1">spec_list[j]</span><span class="s4">}\n</span><span class="s2">&quot;</span><span class="s1">)</span>

        <span class="s1">file.write(</span><span class="s2">&quot;</span><span class="s4">\n</span><span class="s2">&quot;</span><span class="s1">)</span>
        <span class="s1">file.write(</span><span class="s2">&quot;</span><span class="s4">\n</span><span class="s2">&quot;</span><span class="s1">)</span>

        <span class="s0">for </span><span class="s1">k </span><span class="s0">in </span><span class="s1">range(</span><span class="s3">11</span><span class="s1">, </span><span class="s3">15</span><span class="s1">):</span>
            <span class="s1">file.write(</span><span class="s2">f&quot;</span><span class="s4">{</span><span class="s1">spec_name[k]</span><span class="s4">}</span><span class="s2">: </span><span class="s4">{</span><span class="s1">spec_list[k]</span><span class="s4">}\n</span><span class="s2">&quot;</span><span class="s1">)</span>
        <span class="s1">file.close()</span>
        <span class="s1">print(</span><span class="s2">f&quot;Data is saved in Text file named as </span><span class="s4">{</span><span class="s1">Vehicle_name</span><span class="s4">}</span><span class="s2">.&quot;</span><span class="s1">)</span>
    <span class="s0">else</span><span class="s1">:</span>
        <span class="s1">print(</span><span class="s2">'Input Error!'</span><span class="s1">)</span>
        <span class="s1">print(</span><span class="s2">'Enter valid input.'</span><span class="s1">)</span>
        <span class="s1">print(</span><span class="s2">'The output has not been saved in a file.'</span><span class="s1">)</span>



    <span class="s1">print(</span><span class="s2">&quot;Entry 2nd gear: {}&quot;</span><span class="s1">.format(calculation.Entry_Speed_2nd_Gear(peak_power_rpm, total_2nd_gear_ratio, fact)))</span>
    <span class="s1">print(</span><span class="s2">&quot;Entry 3rd gear: {}&quot;</span><span class="s1">.format(calculation.Entry_Speed_3rd_Gear(peak_power_rpm, total_3rd_gear_ratio, fact)))</span>
    <span class="s1">print(</span><span class="s2">&quot;Exit speed in 2nd gear: {}&quot;</span><span class="s1">.format(calculation.Exit_Speed_2nd_Gear(peak_power_rpm, total_2nd_gear_ratio, fact)))</span>
    <span class="s1">print(</span><span class="s2">&quot;Exit speed in 3rd gear: {}&quot;</span><span class="s1">.format(calculation.Exit_Speed_3rd_Gear(peak_power_rpm, total_3rd_gear_ratio, fact)))</span>

<span class="s1">temp = input(</span><span class="s2">&quot;please press any key to quit!&quot;</span><span class="s1">)</span>
<span class="s1">print(</span><span class="s2">&quot;Thanks! for using this application.&quot;</span><span class="s1">)</span></pre>
</body>
</html>